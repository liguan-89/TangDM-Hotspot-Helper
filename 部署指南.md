# 🚗 比亚迪唐DM热点自启动应用部署指南

## 📦 项目文件清单

### 核心源代码文件
```
TangDMHotspotSimple/
├── src/main/java/com/tangdm/hotspotsimple/
│   ├── HotspotHelper.java      # 热点控制核心类
│   ├── BootReceiver.java       # 开机广播接收器
│   ├── HotspotService.java     # 后台保活服务
│   ├── SimpleAccessibilityService.java  # 无障碍服务
│   └── MainActivity.java       # 配置界面
├── src/main/res/
│   ├── values/strings.xml      # 字符串资源
│   └── xml/simple_accessibility_config.xml  # 无障碍服务配置
├── AndroidManifest.xml         # 应用清单文件
├── build.gradle                # 构建配置文件
├── build.sh                    # 一键构建脚本
├── gradlew                     # Gradle包装器
└── README.md                   # 项目说明
```

### 已创建的文件状态
✅ **所有核心文件已创建完成**

## 🛠️ 构建环境准备

### 1. 系统要求
- **操作系统**: macOS / Linux / Windows
- **Java版本**: JDK 8 或更高
- **Android SDK**: Android 7.0 (API 24) SDK
- **存储空间**: 至少 2GB 可用空间

### 2. 安装Android Studio（推荐）
1. 下载 Android Studio: https://developer.android.com/studio
2. 安装时选择 Android 7.0 (API 24) SDK
3. 配置环境变量（可选）

### 3. 命令行构建（无需Android Studio）
```bash
# 安装必要的工具
# macOS
brew install --cask android-sdk
brew install gradle

# Ubuntu/Debian
sudo apt-get install android-sdk gradle

# 设置环境变量
export ANDROID_HOME=~/Library/Android/sdk  # macOS
export PATH=$PATH:$ANDROID_HOME/tools:$ANDROID_HOME/platform-tools
```

## 🚀 构建APK步骤

### 方法1：使用构建脚本（推荐）
```bash
# 进入项目目录
cd /Users/liguan/.openclaw/workspace/TangDMHotspotSimple

# 给脚本执行权限
chmod +x build.sh gradlew

# 执行构建
./build.sh
```

### 方法2：手动构建
```bash
# 清理项目
./gradlew clean

# 构建调试版APK
./gradlew assembleDebug

# 构建发布版APK（需要签名）
./gradlew assembleRelease
```

### 构建输出
构建成功后，APK文件位于：
```
app/build/outputs/apk/debug/app-debug.apk
```

## 📱 安装到车机

### 准备工作
1. **开启车机开发者选项**：
   - 进入车机设置 → 关于设备
   - 连续点击"版本号"7次
   - 返回设置，找到"开发者选项"
   - 开启"USB调试"

2. **连接车机**：
   - 使用USB数据线连接车机和电脑
   - 车机提示时选择"文件传输"模式
   - 电脑上确认USB调试授权

### 安装方法

#### 方法1：ADB安装（最方便）
```bash
# 检查设备连接
adb devices

# 安装APK
adb install app/build/outputs/apk/debug/app-debug.apk

# 如果已安装旧版本，使用-r参数重新安装
adb install -r app/build/outputs/apk/debug/app-debug.apk
```

#### 方法2：U盘安装
1. 将APK文件复制到U盘根目录
2. U盘格式化为FAT32或exFAT
3. 将U盘插入车机USB接口
4. 用车机文件管理器打开APK文件
5. 点击安装，按照提示完成

#### 方法3：车机浏览器下载
1. 将APK上传到网盘或HTTP服务器
2. 用车机浏览器访问下载链接
3. 下载完成后点击安装

## 🔧 应用配置步骤

### 首次运行配置流程

#### 步骤1：打开应用
- 在车机应用列表中找到"唐DM热点"
- 点击图标打开应用

#### 步骤2：开启无障碍权限
1. 在主界面点击"🔧 开启无障碍权限"
2. 系统跳转到无障碍设置页面
3. 在服务列表中找到"唐DM热点"
4. 点击右侧开关开启服务
5. 返回应用（按返回键或主页键）

#### 步骤3：测试热点功能
1. 点击"📡 立即测试热点"
2. 等待提示"正在尝试开启热点..."
3. 查看状态显示"✅ 热点开启成功！"
4. 用手机或其他设备连接热点测试
   - SSID: TangDM_XXXX (XXXX为设备标识)
   - 密码: 12345678

#### 步骤4：完成配置
1. 点击"✅ 完成配置（后台运行）"
2. 应用提示"配置完成！应用将在后台运行"
3. 应用自动进入后台运行模式

### 验证配置
1. **检查状态**：重新打开应用，查看状态显示
2. **查看日志**：`adb logcat | grep TangDMHotspot`
3. **测试自启动**：重启车机，等待5秒检查热点

## 📊 功能测试清单

### 基础功能测试
- [ ] 应用安装成功
- [ ] 无障碍权限开启成功
- [ ] 手动热点开启测试成功
- [ ] 热点连接测试成功（手机连接）

### 自启动测试
- [ ] 完全关闭车机电源
- [ ] 重新启动车机
- [ ] 等待5秒
- [ ] 检查热点是否自动开启
- [ ] 连接热点测试网络

### 稳定性测试
- [ ] 多次重启车机测试
- [ ] 长时间运行测试（24小时）
- [ ] 不同网络环境测试
- [ ] 多设备连接测试

## 🔍 故障排除

### 常见问题及解决方案

#### 问题1：ADB无法连接车机
**症状**：`adb devices`显示空列表
**解决**：
1. 检查USB线是否正常
2. 车机是否开启USB调试
3. 电脑USB驱动是否安装
4. 尝试不同的USB端口

#### 问题2：应用安装失败
**症状**：安装时提示"应用未安装"或"解析包错误"
**解决**：
1. 检查APK是否完整
2. 确认车机系统为Android 7.0
3. 清理旧版本：`adb uninstall com.tangdm.hotspotsimple`
4. 重新构建APK

#### 问题3：热点无法开启
**症状**：点击测试热点后显示失败
**解决**：
1. 查看详细日志：`adb logcat | grep TangDMHotspot`
2. 检查WiFi是否已关闭（热点和WiFi冲突）
3. 手动在车机设置中开启热点一次
4. 重启车机后重试

#### 问题4：无障碍服务无法开启
**症状**：无障碍设置中找不到应用或开关灰色
**解决**：
1. 确认应用已安装并运行过一次
2. 重启车机后重试
3. 检查车机安全设置
4. 重新安装应用

### 日志收集
```bash
# 收集应用日志
adb logcat -d | grep TangDMHotspot > hotspot_log.txt

# 收集系统日志
adb logcat -d > system_log.txt

# 收集车机信息
adb shell getprop > device_props.txt
```

## ⚙️ 高级配置

### 修改热点参数
如需修改热点名称或密码，编辑`HotspotHelper.java`：
```java
// 修改热点名称
wifiConfig.SSID = "TangDM_" + deviceId;  // 第85行

// 修改热点密码
wifiConfig.preSharedKey = "12345678";    // 第88行
```

### 调整延迟时间
修改`BootReceiver.java`中的延迟时间：
```java
// 修改5秒延迟（第31行）
}, 5000);  // 5000毫秒 = 5秒

// 修改重试延迟（第49行）
}, 3000);  // 3000毫秒 = 3秒
```

### 自定义日志级别
修改各个Java文件中的日志标签：
```java
private static final String TAG = "TangDMHotspot";  // 可修改为其他名称
```

## 📈 性能优化建议

### 车机系统优化
1. **加入白名单**：在车机后台管理中，将应用加入白名单
2. **关闭电池优化**：在电池设置中，关闭对本应用的优化
3. **自启动管理**：确保应用有自启动权限

### 应用优化
1. **减少日志输出**：发布版本可关闭详细日志
2. **优化资源使用**：应用本身资源占用极低
3. **避免频繁唤醒**：只在必要时执行操作

## 🔄 更新和维护

### 版本管理
- **当前版本**: 1.0
- **构建时间**: 2026年2月9日
- **兼容系统**: Android 7.0 (API 24)

### 更新流程
如需更新应用：
1. 修改源代码
2. 重新构建APK
3. 卸载旧版本
4. 安装新版本
5. 重新配置

### 备份和恢复
建议备份：
1. 源代码目录
2. 构建的APK文件
3. 配置记录
4. 测试日志

## 🎯 成功标准

### 功能验收标准
- ✅ 应用安装成功并正常运行
- ✅ 无障碍权限正常开启
- ✅ 手动热点开启功能正常
- ✅ 开机5秒自启动功能正常
- ✅ 热点连接稳定可用

### 用户体验标准
- ✅ 配置过程简单易懂
- ✅ 界面清晰直观
- ✅ 后台运行稳定
- ✅ 无干扰提示

### 技术标准
- ✅ 代码结构清晰
- ✅ 错误处理完善
- ✅ 日志记录完整
- ✅ 资源占用合理

---

## 🚀 开始部署！

按照以下步骤开始部署：

1. **环境准备**：确保有Android构建环境
2. **构建APK**：运行`./build.sh`构建应用
3. **安装到车机**：使用ADB或U盘安装
4. **配置应用**：按照配置步骤操作
5. **测试功能**：完成功能测试清单
6. **验证自启动**：重启车机测试自动功能

**祝您部署顺利！如有问题，请参考故障排除部分或查看详细日志。** 🎉

---

**部署状态跟踪**：
- [ ] 环境准备完成
- [ ] APK构建完成  
- [ ] 安装到车机完成
- [ ] 应用配置完成
- [ ] 功能测试完成
- [ ] 自启动验证完成